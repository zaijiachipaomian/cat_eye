!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=72)}([function(e,t){e.exports=React},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e=[].concat(Array.prototype.slice.call(arguments)).join("-"),function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return 0==n.length?e||"":n.map(function(t){return t?"!"==t.charAt(0)?t.substring(1):e?e+"-"+t:t:""}).join(" ")}}},,function(e,t){e.exports=Immutable},,function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 1===t.length?o.apply(void 0,t):i.apply(void 0,t)}function o(e){var t=void 0;return"undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys?t=Reflect.ownKeys(e.prototype):(t=Object.getOwnPropertyNames(e.prototype),"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e.prototype)))),t.forEach(function(t){if("constructor"!==t){var n=Object.getOwnPropertyDescriptor(e.prototype,t);"function"==typeof n.value&&Object.defineProperty(e.prototype,t,i(e,t,n))}}),e}function i(e,t,n){var r=n.value;if("function"!=typeof r)throw new Error("@autobind decorator can only be applied to methods not: "+("undefined"==typeof r?"undefined":s(r)));var o=!1;return{configurable:!0,get:function(){if(o||this===e.prototype||this.hasOwnProperty(t))return r;var n=r.bind(this);return o=!0,Object.defineProperty(this,t,{value:n,configurable:!0,writable:!0}),o=!1,n}}}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},,function(e,t,n){"use strict";var r=n(27),o={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:r}},registerDefault:function(){}};e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CK=t.SITE_COOKIE=t.FILE_NAME=t.URL_SYNC=t.URL_CAPTCHA=t.URL_REWARD=t.URL_PREVIEW=t.URL_REMOVE_PHOTO=t.URL_UPLOAD=t.URL_MODIFY=t.URL_CREATE=t.URL_SUBJECT_INFO=t.URL_VIDEO_INFO=t.EDITOR_CLS_PREFIX=void 0;var r=n(25);t.EDITOR_CLS_PREFIX="DRE",t.URL_VIDEO_INFO="//www.douban.com/j/note/get_video_info",t.URL_SUBJECT_INFO="//www.douban.com/j/note/get_subject_info",t.URL_CREATE="/j/review/create",t.URL_MODIFY="/j/review/{id}/update",t.URL_UPLOAD="/j/review/upload_image",t.URL_REMOVE_PHOTO="/j/review/delete_image",t.URL_PREVIEW="/j/review/preview",t.URL_REWARD="//www.douban.com/mine/donate_apply/",t.URL_CAPTCHA="//www.douban.com/j/misc/captcha",t.URL_SYNC=window._URL_SYNC||"/settings/sync",t.FILE_NAME=window._UPLOAD_FILENAME||"picfile",t.SITE_COOKIE=window._POST_PARAMS&&_POST_PARAMS.siteCookie,t.CK=(0,r.getCookie)("ck")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(26),i=r(o);t.default=i.default},function(e,t,n){"use strict";function r(){}function o(e){if(!m(e))return e;var t=[];for(var n in e)i(t,n,e[n]);return t.join("&")}function i(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){i(e,t,n)});else if(m(n))for(var r in n)i(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function s(e){for(var t,n,r={},o=e.split("&"),i=0,s=o.length;i<s;++i)t=o[i],n=t.indexOf("="),n==-1?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function a(e){for(var t,n,r,o,i=e.split(/\r?\n/),s={},a=0,u=i.length;a<u;++a)n=i[a],t=n.indexOf(":"),t!==-1&&(r=n.slice(0,t).toLowerCase(),o=g(n.slice(t+1)),s[r]=o);return s}function u(e){return/[\/+]json\b/.test(e)}function l(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function c(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new l(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,n.xhr?(e.rawResponse="undefined"==typeof n.xhr.responseType?n.xhr.responseText:n.xhr.response,e.status=n.xhr.status?n.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),n.callback(e)}n.emit("response",t);var r;try{n._isResponseOK(t)||(r=new Error(t.statusText||"Unsuccessful HTTP response"))}catch(e){r=e}r?(r.original=e,r.response=t,r.status=t.status,n.callback(r,t)):n.callback(null,t)})}function f(e,t,n){var r=b("DELETE",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}var p,d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"undefined"!=typeof window?p=window:"undefined"!=typeof self?p=self:(console.warn("Using browser-only version of superagent in non-browser environment"),p=void 0);var h=n(24),y=n(37),m=n(15),_=n(38),v=n(36),b=t=e.exports=function(e,n){return"function"==typeof n?new t.Request("GET",e).end(n):1==arguments.length?new t.Request("GET",e):new t.Request(e,n)};t.Request=c,b.getXHR=function(){if(!(!p.XMLHttpRequest||p.location&&"file:"==p.location.protocol&&p.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")};var g="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};b.serializeObject=o,b.parseString=s,b.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},b.serialize={"application/x-www-form-urlencoded":o,"application/json":JSON.stringify},b.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},_(l.prototype),l.prototype._parseBody=function(e){var t=b.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&u(this.type)&&(t=b.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},l.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},b.Response=l,h(c.prototype),y(c.prototype),c.prototype.type=function(e){return this.set("Content-Type",b.types[e]||e),this},c.prototype.accept=function(e){return this.set("Accept",b.types[e]||e),this},c.prototype.auth=function(e,t,n){1===arguments.length&&(t=""),"object"===("undefined"==typeof t?"undefined":d(t))&&null!==t&&(n=t,t=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});var r=function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,n,r)},c.prototype.query=function(e){return"string"!=typeof e&&(e=o(e)),e&&this._query.push(e),this},c.prototype.attach=function(e,t,n){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,n||t.name)}return this},c.prototype._getFormData=function(){return this._formData||(this._formData=new p.FormData),this._formData},c.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),n(e,t)},c.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},c.prototype.buffer=c.prototype.ca=c.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},c.prototype.pipe=c.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},c.prototype._isHost=function(e){return e&&"object"===("undefined"==typeof e?"undefined":d(e))&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},c.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||r,this._finalizeQueryString(),this._end()},c.prototype._end=function(){var e=this,t=this.xhr=b.getXHR(),n=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==n){var r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var r=function(t,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=t,e.emit("progress",n)};if(this.hasListeners("progress"))try{t.onprogress=r.bind(null,"download"),t.upload&&(t.upload.onprogress=r.bind(null,"upload"))}catch(e){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof n&&!this._isHost(n)){var o=this._header["content-type"],i=this._serializer||b.serialize[o?o.split(";")[0]:""];!i&&u(o)&&(i=b.serialize["application/json"]),i&&(n=i(n))}for(var s in this.header)null!=this.header[s]&&this.header.hasOwnProperty(s)&&t.setRequestHeader(s,this.header[s]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send("undefined"!=typeof n?n:null),this},b.agent=function(){return new v},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){v.prototype[e.toLowerCase()]=function(t,n){var r=new b.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}),v.prototype.del=v.prototype.delete,b.get=function(e,t,n){var r=b("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},b.head=function(e,t,n){var r=b("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},b.options=function(e,t,n){var r=b("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},b.del=f,b.delete=f,b.patch=function(e,t,n){var r=b("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},b.post=function(e,t,n){var r=b("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},b.put=function(e,t,n){var r=b("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n;if(!e)return n=document.createElement("div"),document.body.appendChild(n),n;n="string"==typeof e?document.querySelector(e):e;var r=document.createElement("div");switch(t){case"append":return n.appendChild(r),r;case"before":return n.parentNode.insertBefore(r,n),r;case"after":return n.nextSibling?n.parentNode.insertBefore(r,n.nextSibling):n.parentNode.appendChild(r),r}return n}},,function(e,t,n){"use strict";function r(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":o(e))}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),p=r(f),d=(n(5),n(3)),h=(n(8),n(18)),y=r(h),m=n(6),_=r(m),v=n(10),b=r(v),g=n(1),E=r(g),w=n(21),O=r(w),T=n(28),k=r(T),C=n(23),S=n(9),R=(0,E.default)("review-editor-popup-setting"),P=(0,_.default)((l=u=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={data:e.data||(0,d.Map)(),errors:(0,d.Map)(),displayStatement:!1},n}return s(t,e),c(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.displayStatement,r=t.data,o=t.errors,i=this.props,s=i.title,a=i.displayRating,u=i.displaySpoiler,l=i.subjectInfo,c=i.onClose,f=(i.onSubmit,i.onBack),d=i.dialogClassNamePrefix,h=i.submitButtonLabel,m=i.cancelButtonLabel,_=p.default.createElement("div",{className:R("share-link")},p.default.createElement("a",{href:S.URL_SYNC,target:"_blank"},"分享设置")),v=null,g=null;a&&(v=p.default.createElement("div",{className:R("fieldset")},p.default.createElement("div",{className:R("label")},"评价 "+l.get("title"),":"),p.default.createElement(O.default,{value:r.get("rating"),size:16,onSelected:function(t){return e.setState({data:r.set("rating",t)})}}))),u&&(g=p.default.createElement("div",{className:R("fieldset")},p.default.createElement("div",{className:R("label")},"剧透提示:"),p.default.createElement("div",{className:R("fields")},p.default.createElement("input",{type:"checkbox",id:R("check-spoiler"),onChange:function(t){return e.setState({displayStatement:!1,data:r.set("is_spoiler",t.target.checked)})},checked:r.get("is_spoiler")}),p.default.createElement("label",{htmlFor:R("check-spoiler")},"有关键情节透露"))));var E=p.default.createElement("div",null,v,g,p.default.createElement("div",{className:R("fieldset")},p.default.createElement("div",{className:R("label")},"版权声明:"),p.default.createElement("div",{className:R("fields")},p.default.createElement("input",{type:"checkbox",id:R("terms-original"),onChange:function(t){return e.setState({errors:o.remove("reward"),displayStatement:!1,data:r.set("is_original",t.target.checked)})},checked:r.get("is_original")}),p.default.createElement("label",{htmlFor:R("terms-original")},"这是我的原创内容，我已阅读并同意"),p.default.createElement("a",{href:"javascript:;",ref:function(t){return e._link_statement=t},target:"_blank",onClick:function(){return e.setState({displayStatement:!n})}},"《豆瓣原创评论声明》")),p.default.createElement(k.default,{duration:".1",mode:n?"open":"close"},p.default.createElement("div",{className:R("statement-container")},C.originalStatement,p.default.createElement("div",null,p.default.createElement("a",{href:"javascript:;",className:R("button-fold-up"),onClick:function(t){return e.setState({displayStatement:!1})}},"收起"))))),p.default.createElement("div",{className:R("fieldset")},p.default.createElement("div",{className:R("label")},"赞赏设置:"),p.default.createElement("div",{className:R("fields")},r.get("is_open_reward")?p.default.createElement("span",null,p.default.createElement("input",{type:"checkbox",id:R("terms-reward"),onChange:function(t){return e.setState({errors:o.remove("reward"),data:r.set("is_accept_reward",t.target.checked)})},defaultChecked:r.get("is_accept_reward")}),p.default.createElement("label",{htmlFor:R("terms-reward")},"这篇评论接受赞赏")):p.default.createElement("a",{href:S.URL_REWARD,target:"_blank"}," 开通赞赏功能 "),this.errorMsg(o.get("reward")),_)));return p.default.createElement("div",null,p.default.createElement(b.default,{display:!0,onClose:function(e){return c&&c()},classNamePrefix:d,title:s},p.default.createElement("form",{className:R("form"),onSubmit:this.handleSubmit},E,r.get("need_captcha")?p.default.createElement("div",{className:R("captcha-container")},p.default.createElement(y.default,{value:r.get("captcha"),token:r.get("captcha_id"),image:r.get("captcha_image"),onChange:function(t){return e.setState({data:r.set("captcha",t.value).set("captcha_id",t.token).set("captcha_image",t.image)})}}),this.errorMsg(o.get("captcha"))):null,p.default.createElement("div",{className:R("submit")},p.default.createElement("a",{href:"javascript:;",onClick:function(e){return f&&f()}},m),p.default.createElement("button",null,h)))))}},{key:"errorMsg",value:function(e){return e&&p.default.createElement("div",{className:R("error")},e)}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.data,n=(0,d.Map)();t.get("is_accept_reward")&&!t.get("is_original")&&(n=n.set("reward","只有原创内容才能接受赞赏")),t.get("need_captcha")&&!t.get("captcha")&&(n=n.set("captcha","请填写验证码")),this.setState({errors:n}),n.size||this.props.onSubmit&&this.props.onSubmit(t)}}]),t}(f.Component),u.defaultProps={title:"设置",dialogClassNamePrefix:S.EDITOR_CLS_PREFIX,submitButtonLabel:"发表",cancelButtonLabel:"返回编辑"},a=l))||a;t.default=P},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(1),a=r(s),u=n(11),l=r(u),c=n(9),f=(0,a.default)("review-editor-captcha");t.default=function(e){return i.default.createElement("div",{className:f("container")},i.default.createElement("div",{className:f("inner")},i.default.createElement("div",{className:f("field")},i.default.createElement("a",{href:"javascript:;",onClick:function(){return l.default.get(c.URL_CAPTCHA).end(function(t,n){return!t&&!n.body.r&&e.onChange&&e.onChange({value:e.value,token:n.body.token,image:n.body.url})})}},i.default.createElement("img",{src:e.image}))),i.default.createElement("div",{className:f("field")},i.default.createElement("input",{type:"text",value:e.value,onChange:function(t){return e.onChange&&e.onChange({value:t.target.value,token:e.token,image:e.image})},placeholder:e.placeholder||"请输入验证码"}))))}},,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(32),i=r(o);t.default=i.default},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.originalStatement=void 0;var o=n(0),i=r(o);t.originalStatement=i.default.createElement("div",{className:"review-editor-statement"},i.default.createElement("div",{className:"review-editor-statement-inner"},i.default.createElement("p",null,"《豆瓣原创评论声明》是豆瓣用户对其独立完成创作的针对书籍、电影、音乐等进行评论的文字作品（不包括改编、翻译、注释、整理、汇编他人已有作品而产生的新作品，以及大量摘抄引用被评论的书籍原文、影视台词、唱片歌词等的评论）的声明。豆瓣用户在发起原创声明后，其作品会被标识为豆瓣原创评论。"),i.default.createElement("p",null,"豆瓣不允许用户发布如下内容并进行原创声明：",i.default.createElement("br",null),"1. 抄袭、剽窃、歪曲、篡改他人作品的内容；",i.default.createElement("br",null),"2. 色情、激进时政、意识形态、暴力、不实信息等方面的内容；",i.default.createElement("br",null),"3. 违反法律法规、侵犯第三方合法权益，及违反《豆瓣使用协议》《豆瓣社区指导原则》等的内容；",i.default.createElement("br",null),"4. 其他豆瓣认为不适宜公开发布的内容。",i.default.createElement("br",null)),i.default.createElement("p",null,"针对违反《豆瓣原创评论声明》的用户，根据情节严重程度，豆瓣有权予以处罚。处罚方式包括取消原创声明资格、禁言3天至30天等。")))},function(e,t,n){"use strict";function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setCookie=function(e,t,n,r){var o=new Date,i=void 0;o.setTime(o.getTime()+24*(t||30)*60*60*1e3);for(i in e)document.cookie=i+"="+e[i]+"; expires="+o.toGMTString()+(n&&"; domain="+n)+"; path="+(r||"/")},t.getCookie=function(e){var t=e+"=",n=document.cookie.split(";"),r=void 0,o=void 0;for(r=0;r<n.length;r++){for(o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length).replace(/\"/g,"")}return null}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),p=r(f),d=n(5),h=r(d),y=n(6),m=r(y),_=n(1),v=r(_),b=(0,m.default)((l=u=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={display:e.display},n}return s(t,e),c(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({display:e.display})}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.children,r=e.displayClose,o=this.state.display,i=this.getClassNameBuilder(),s=p.default.createElement("div",{className:i("dialog-panel")},r&&p.default.createElement("a",{href:"javascript:;",className:i("dialog-close"),onClick:this.handleClose},"×"),p.default.createElement("div",{className:i("dialog-content")},t&&p.default.createElement("div",{className:i("dialog-hd")},t),p.default.createElement("div",{className:i("dialog-bd")},n))),a=p.default.createElement("div",{className:i("dialog-container"),onWheel:function(e){return e.preventDefault()}},p.default.createElement("div",{ref:"panel_wrapper",className:i("dialog-panel-wrapper"),onWheel:this.handleWheel},s));return o&&a}},{key:"getClassNameBuilder",value:function(){return this._cls||(this._cls=(0,v.default)(this.props.classNamePrefix)),this._cls}},{key:"handleWheel",value:function(e){e.stopPropagation();var t=h.default.findDOMNode(this.refs.panel_wrapper),n=t.scrollTop+e.deltaY;if(n<=0||n>=t.scrollHeight-t.clientHeight)return void e.preventDefault()}},{key:"handleClose",value:function(e){e.preventDefault(),this.setState({display:!1}),this.props.onClose&&this.props.onClose()}}]),t}(f.Component),u.defaultProps={display:!1,displayClose:!0,classNamePrefix:""},a=l))||a;t.default=b},function(e,t,n){"use strict";function r(e){return function(){return e}}var o=function(){};o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(29),i=r(o);t.default=i.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=r(l),f=n(5),p=n(8),d=n(30),h=function(e){function t(e){i(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={processing:!1,height:0},n}return a(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.onEnd;this._contentHeight=this._rootNode.scrollHeight,this._transEvent=(0,p.listen)(this._rootNode,d.transitionEndName,function(n){e.setState({processing:!1}),t&&t(e.props.mode)}),this.change()}},{key:"componentWillUnmount",value:function(){this._transEvent.remove()}},{key:"componentDidUpdate",value:function(e){e.mode!==this.props.mode&&this.change()}},{key:"change",value:function(){this.setState({processing:!0,height:"close"==this.props.mode?0:this._contentHeight})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.children,i=(n.closeStyle,n.openStyle,n.className),s=(n.mode,n.duration),a=n.timing,u=this.state,l=u.height,p=u.processing,h=(e={},o(e,(0,d.cssPropName)("transition"),"height "+s+"s "+a+",\n                                      opacity "+s+"s "+a),o(e,"overflow",p?"hidden":"auto"),o(e,"opacity",l?1:0),o(e,"height",l),e);return c.default.createElement("div",{ref:function(e){return t._rootNode=(0,f.findDOMNode)(e)},className:i,style:h},r)}}]),t}(l.Component);h.defaultProps={mode:"close",duration:.3,timing:"ease-out"},t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.cssPropName=function(e){for(var t=["","Webkit","ms","Moz","O"],n=0,r=void 0;"undefined"!=typeof(r=t[n]);){if(r=r?""+r+e.charAt(0).toUpperCase()+e.substr(1):e,r in document.documentElement.style)return r;n++}return e};t.transitionEndName=function(e){var t={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend"};return t[e]}(r("transition"))},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),p=n(1),d=r(p),h=(u=a=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={wantScore:null},n}return s(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.ratingItems,o=t.classNamePrefix,i=this.getClassNameBuilder(o),s=null==this.state.wantScore?n:this.state.wantScore;return f.default.createElement("div",{className:i("container")},r.map(function(t){return e.star(t[1]<=s,t[1])}),s?f.default.createElement("span",{className:i("label")},r[Math.round(s)-1][0]):null)}},{key:"star",value:function(e,t){var n=this,r=this.props,o=r.size,i=r.onSelected,s=r.selectedColor,a=r.unselectedColor,u=r.classNamePrefix,l=r.renderRatingItem,c=e?s:a,p=e?s:"none",d=this.getClassNameBuilder(u);return f.default.createElement("span",{key:t,onMouseEnter:function(e){return n.setState({wantScore:t})},onMouseLeave:function(e){return n.setState({wantScore:null})},onClick:function(e){return i&&i(t)},className:d("star",e?"full":"")},l(c,p,o,e))}},{key:"getClassNameBuilder",value:function(e){return this._cls?this._cls:(this._cls=(0,d.default)(e),this._cls)}}]),t}(c.Component),a.defaultProps={value:0,size:18,classNamePrefix:"rating-editor",ratingItems:[["很差",1],["较差",2],["还行",3],["推荐",4],["力荐",5]],selectedColor:"#f2ae4b",unselectedColor:"#aaaaaa",renderRatingItem:function(e,t,n){return f.default.createElement("svg",{width:n,height:n,viewBox:"0 0 18 17"},f.default.createElement("polygon",{stroke:e,strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",fill:t,fillRule:"evenodd",points:"9.00000023 13.252274 4.05572809 16.2562855 5.46226769 10.6880553 1 6.82738251 6.80466211 6.82738254 9 1 11.3407359 6.82738254 17 6.82738251 12.1897095 10.6880553 13.9442719 16.2562855"}))}},u);t.default=h},,,,function(e,t,n){"use strict";function r(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){r.prototype[e]=function(){return this._defaults.push({fn:e,arguments:arguments}),this}}),r.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},e.exports=r},function(e,t,n){"use strict";function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;
},s=n(15);e.exports=r,r.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},r.prototype.parse=function(e){return this._parser=e,this},r.prototype.responseType=function(e){return this._responseType=e,this},r.prototype.serialize=function(e){return this._serializer=e,this},r.prototype.timeout=function(e){if(!e||"object"!==("undefined"==typeof e?"undefined":i(e)))return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}return this},r.prototype.retry=function(e,t){return 0!==arguments.length&&e!==!0||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var a=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];r.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(e,t);if(n===!0)return!0;if(n===!1)return!1}catch(e){console.error(e)}if(t&&t.status&&t.status>=500&&501!=t.status)return!0;if(e){if(e.code&&~a.indexOf(e.code))return!0;if(e.timeout&&"ECONNABORTED"==e.code)return!0;if(e.crossDomain)return!0}return!1},r.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},r.prototype.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},r.prototype.catch=function(e){return this.then(void 0,e)},r.prototype.use=function(e){return e(this),this},r.prototype.ok=function(e){if("function"!=typeof e)throw Error("Callback required");return this._okCallback=e,this},r.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},r.prototype.get=function(e){return this._header[e.toLowerCase()]},r.prototype.getHeader=r.prototype.get,r.prototype.set=function(e,t){if(s(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},r.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},r.prototype.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),s(e)){for(var n in e)this.field(n,e[n]);return this}if(Array.isArray(t)){for(var r in t)this.field(e,t[r]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=""+t),this._getFormData().append(e,t),this},r.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},r.prototype._auth=function(e,t,n,r){switch(n.type){case"basic":this.set("Authorization","Basic "+r(e+":"+t));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e)}return this},r.prototype.withCredentials=function(e){return void 0==e&&(e=!0),this._withCredentials=e,this},r.prototype.redirects=function(e){return this._maxRedirects=e,this},r.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw TypeError("Invalid argument");return this._maxResponseSize=e,this},r.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},r.prototype.send=function(e){var t=s(e),n=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(t&&s(this._data))for(var r in e)this._data[r]=e[r];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],"application/x-www-form-urlencoded"==n?this._data=this._data?this._data+"&"+e:e:this._data=(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)},r.prototype.sortQuery=function(e){return this._sort="undefined"==typeof e||e,this},r.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(t>=0){var n=this.url.substring(t+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,t)+"?"+n.join("&")}}},r.prototype._appendQueryString=function(){console.trace("Unsupported")},r.prototype._timeoutError=function(e,t,n){if(!this._aborted){var r=new Error(e+t+"ms exceeded");r.timeout=t,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},r.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},function(e,t,n){"use strict";function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}var i=n(39);e.exports=r,r.prototype.get=function(e){return this.header[e.toLowerCase()]},r.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=i.type(t);var n=i.params(t);for(var r in n)this[r]=n[r];this.links={};try{e.link&&(this.links=i.parseLinks(e.link))}catch(e){}},r.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e}},function(e,t,n){"use strict";t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(e[r]=o),e},{})},t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */),r=n[0].slice(1,-1),o=n[1].split(/ *= */)[1].slice(1,-1);return e[o]=r,e},{})},t.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(0),i=r(o),s=n(5),a=n(3),u=n(13),l=r(u),c=n(16),f=r(c);n(68);var p=new((0,a.Record)({rating:0,is_original:0,is_spoiler:0,is_accept_reward:0,is_open_reward:0,captcha:"",need_captcha:0,captcha_id:"",captcha_image:"",display:!1})),d=function(e){return function(t){if(t.display)var n=p.merge(t.setting);(0,s.render)(t.display?i.default.createElement(f.default,{key:t.review_id,data:n,title:"评论设置",subjectInfo:(0,a.Map)({title:t.subjectTitle}),displayRating:t.displayRating,displaySpoiler:t.displaySpoiler,dialogClassNamePrefix:"review-setting",submitButtonLabel:"确定",cancelButtonLabel:"取消",onSubmit:function(e){d({display:!1}),t.onSubmit&&t.onSubmit(e.toJS())},onClose:function(){return d({display:!1})},onBack:function(){d({display:!1}),t.onCancel&&t.onCancel()}}):i.default.createElement("div",null),e)}}((0,l.default)());window.globalReviewSetting={open:function(e){e.display=!0,d(e)},close:function(){d({display:!1})}}}]);