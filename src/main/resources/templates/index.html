<!DOCTYPE html>
<!--中文版本-->
<html lang="zh_cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>首页</title>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">

    <script>
        <!--动态加载实现函数-->
        $(document).ready(function () {

            // 获取新闻详情
            const NEWS_ID = '/news/id';
            const USR_REG_URL = '/usr/reg';
            const USR_LOGIN_URL = '/usr/login';
            const USR_RE_BACK_PWD = '/usr/re_back_pwd';
            const USR_VALID_CODE = '/usr/valid_code';
            const USR_HOME = '/usr';
            const FILMS = '/films?offset=';
            const FILMS_ROOT_URL = '/films/';  // todo 这里添加films/90
            const PERSON_ID = '/person/'; // todo 这里添加id
            console.log("hello js");


            let urlRegister = '/reg/validcode';

            let phone_text = $("#phone");
            let reg_phone = /^[1][23576][0-9]{9}$/

            let fetch_valid = $("#fetch_valid");
            console.log(fetch_valid[0])

            fetch_valid.click(function () {

                // 先判断手机号码
                var phone = phone_text.val();
                var ok = reg_phone.test(phone);

                // 正则表达式验证失败
                if (!ok) {
                    alert("手机号码不正确,请重新输入");
                    return ok;
                }

                // 请求后台验证码
                console.log("hello", phone)
            });

            // 获取验证码
            function fetch_valid_code(phone) {

                let reg_phone = /^[1][23576][0-9]{9}$/

                let ok = valid_text(reg_phone, phone);

                if (!ok) {

                    return ok;
                }

                let fetch_valid_url = "/valid_code" // 获取验证码的请求路由
                let data = JSON.stringify({'phone': phone});
                $.post(fetch_valid_url, data, function (data, status) {

                    // todo
                    // if ok 关闭
                });


            }


            // 正则表达式验证..
            function valid_text(pattern, text) {
                return pattern.test(text);
            }

            // 获取电影的信息
            function fetch_films_(offset) {
                $.get(FILMS + offset, function (data, status) {


                });

            }

            //
            function fetch_person(personId) {
                $.get(PERSON_ID + personId, function (data, status) {
                    console.log(JSON.unpack(data));
                });
            }

            // 获取主页消息
            function fetch_index() {
                $.get("/index_data/todayBoxOffice", {}, function (data, status) {

                    data = JSON.parse(data);
                    var list = data.data.list;
                    //console.log(list);
                    for (let i = 0; i < list.length; i++) {
                        if (i == 10) {
                            break;
                        }
                        let obj = list[i];
                        unpack_today_box_office(obj, i + 1);
                        console.log(obj.movieId + "  " + obj.movieName + " rank " + i + 1);
                    }
                });
            }


            // 将今日票房的信息写入dom文档
            function unpack_today_box_office(movie, rank) {
                // todo
                console.log("rank = ", rank);

                $(".right-pannel").append(` <li class="ranking-item ranking-index-${rank}">
                        <a href="/films/${movie.movieId}"  data-act="ticketList-movie-click" >
                            <span class="normal-link-${rank}" >
                                <i class="ranking-index">${rank}</i>
                                <span class="ranking-movie-name">${movie.movieName}</span>
                                <span class="ranking-num-info">
                                    <span class="stonefont">${movie.boxInfo}</span>万
                                </span>
                            </span>
                        </a>
                    </li>`);


            }

            // 首页电影信息
            function unpack_movies_index(movie) {
                // todo
            }

            // 将评论写入dom
            function unpack_comments(comment) {
                // todo
            }

            // 和用户有关的信息
            function unpack_usr(usr) {
                // todo
            }

            // 和电影人有关的信息
            function unpack_person(person) {
                // todo
            }

            // 新闻
            function unpack_news(news) {
                // todo
            }

            // 电影的类型
            function unpack_movies_types(types) {
                // todo
            }

            // 获取首页数据
            fetch_index();
        });


    </script>

    <style>
        .radius-default {
            border-radius: 28px
        }

        .navbar-default {
            height: 56x;;
        }

        .margin-right-default {
            margin-right: -24px;
        }

        .w-h-28 {
            height: 34px;
            width: 34px;
            text-align: center;
        }

        .flex-container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: space-between;
            width: 100%;

        }

        .movie-item {
            height: 230px;
            width: 160px;
            background: greenyellow;
            margin: 30px 0 0 16px;
        }

        .page-pagination {
            text-align: center;
        }

        .pannel {
            height: 32px;
            width: 100%;
            margin-left: 16px;
            left: 32px;
            display: flex;
            flex-direction: row;
            margin: 0 auto;
            justify-content: space-between;
            /* margin-right: -32px !important; */
        }

        .right-pannel {
            width: 100%;
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;

        }

        .pannel-rank {
            height: 32px;;
            width: 100%;
            margin-top: 8px;
            border-bottom-color: gray;
            border-bottom-style: solid;
            border-bottom-width: 0.4px;
        }

        .movie_img {
            width: 160px;
            height: 230px;
        }

        .radius-default {
            border-radius: 28px;
        }

        #logoImg {
            width: 80px;
            height: 70px;
            line-height: 50px;
        }

        #logoDiv {
            margin-top: -25px;

        }

        li {
            list-style-type: none;
        }

        .ranking-index-10, ranking-index-9, ranking-index-8, ranking-index-7, ranking-index-6, ranking-index-5, ranking-index-3, .normal-link {
            font-size: 20px;
            color: gray;
            font-family: "宋体";
            /*            font-style:italic;*/
        }

        a {
            text-decoration: none;
        }

        a:focus, a:hover {
            color: #23527c;
            text-decoration: none;
        }
    </style>

    <script>
        $(document).ready(function () {

            $(".inav li").click(function () {
                //    移除所有的 active
                $(".inav li").removeClass("active");
                // 设置当前点击对象的class 值为active
                $(this).addClass("active")
            })
        });
    </script>
</head>

<body>
<!-- 固定导航条navbar-fixed-top -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <div class="navbar-header">

            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example-navbar-collapse">
                <span class="sr-only">切换导航</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div id="logoDiv">
                <a class="navbar-brand" href="#">
                    <img id="logoImg" src="C:\Users\Administrator\Desktop\logo.png">
                </a>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="example-navbar-collapse">
            <ul class="nav navbar-nav inav">
                <li class="active inav"><a href="#">首页</a></li>
                <li><a href="#" class="">电影</a></li>
                <li><a href="#" class="">榜单</a></li>
                <li><a href="#" class="">热点</a></li>

            </ul>

            <!-- 搜索表单-->
            <form action="##" class="navbar-form navbar-right">
                <div class="form-group radius-default">
                    <input type="text" class="form-control radius-default  margin-right-default" placeholder="找电影 影人 "/>
                    <button type="submit" class="btn  radius-default w-h-28" aria-hidden="true"></span>
                    </button>

                </div>
            </form>


            <ul class="nav navbar-nav navbar-right ">
                <li>
                    <a href="/user/login">登录</a>
                </li>
                <li><a href="#" class="disable">|</a></li>
                <li><a href="/user/reg">注册</a></li>

            </ul>
        </div>
    </div>
</nav>

<div class="container" style="margin-top:56px;">
    <div class="col-sm-10 ">
        <!--标签头部-->
        <div class=" pannel">
            <div style="margin-left:16px;">热映</div>
            <div>更多</div>

        </div>
        <div class="movie-list flex-container">
            <div class="movie-item">
                <a class="item" target="_blank" href="">

                    <div class="cover-wp" data-isnew="false" data-id="25849049">
                        <img class="movie_img" src="C:\XCCCY\网络谜踪.jpg" alt="网络谜踪" data-x="160" data-y="230">
                        <p align="center">网络谜踪<strong>&nbsp;&nbsp;8.6</strong></p>
                    </div>

                </a>
            </div>

        </div>
    </div>
    <div class="col-sm-2 hidden-xs ">
        <div class="container-fluid">
            <div class="right-pannel-title" style="color: green;font-size: 25px;font-style:italic;">票房周榜</div>
            <div class="right-pannel">
                <li class="ranking-item ranking-index-1">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link1" style="color: gold;font-size: 20px;">
            <i class="ranking-index">1</i>
            <span class="ranking-movie-name">海王</span>
            <span class="ranking-num-info">
                <span class="stonefont">5000</span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-2">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link2" style="color: silver;font-size: 19px;">
            <i class="ranking-index">2</i>
            <span class="ranking-movie-name">大黄蜂</span>
            <span class="ranking-num-info">
                <span class="stonefont">2000</span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-3">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link3" style="color: brown;font-size: 18px;">
            <i class="ranking-index">3</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-4">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">4</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-5">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">5</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index6">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">6</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-7">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">7</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-8">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">8</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-9">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">9</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>

                <li class="ranking-item ranking-index-10">
                    <a href="" target="_blank" data-act="ticketList-movie-click" data-val="{movieid:1212512}">
          <span class="normal-link">
            <i class="ranking-index">10</i>
            <span class="ranking-movie-name"></span>
            <span class="ranking-num-info">
                <span class="stonefont"></span>万
              </span>
          </span>
                    </a>
                </li>
            </div>
        </div>
    </div>
</div>

<div class="footer"></div>
</body>

</html>